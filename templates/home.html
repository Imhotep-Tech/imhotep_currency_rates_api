{% extends "layout.html" %}

{% block body %}

<main class="mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8 py-6">
    {% if success %}
        <div class="mb-4 rounded-md border border-green-200 bg-green-50 p-3 text-green-800 text-center shadow-sm">
            <i class="fas fa-check-circle mr-2"></i> {{ success }}
        </div>
    {% endif %}
    
    <div class="text-center mb-6">
        <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-blue-700 mb-2">Imhotep Exchange Rate API</h1>
        <p class="text-sm sm:text-base text-gray-600">Your personal dashboard for API management and documentation</p>
    </div>
    
    <!-- Dashboard Navigation Tabs (Tailwind) -->
    <div class="mb-5">
        <div class="inline-flex w-full md:w-auto items-center justify-between md:justify-start gap-2 rounded-lg bg-white p-1 shadow-sm ring-1 ring-gray-200">
            <button class="tab-btn px-3 py-2 text-sm font-medium rounded-md bg-blue-600 text-white" data-target="#overview">
                <i class="fas fa-home mr-1"></i> Overview
            </button>
            <button class="tab-btn px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-50" data-target="#api-keys">
                <i class="fas fa-key mr-1"></i> API Keys
            </button>
            <button class="tab-btn px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-50" data-target="#documentation">
                <i class="fas fa-book mr-1"></i> Documentation
            </button>
            <button class="tab-btn px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-50" data-target="#convert">
                <i class="fas fa-exchange-alt mr-1"></i> Convert
            </button>
        </div>
    </div>

    <!-- Tab Content -->
    <div id="dashboardTabContent">
        <!-- Overview Tab -->
        <section id="overview" class="block">
            <div class="rounded-xl bg-white shadow-sm ring-1 ring-gray-200 mb-4 overflow-hidden">
                <div class="bg-blue-700 text-white px-4 py-3">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-key text-xl"></i>
                        <h3 class="m-0 text-base font-semibold">Your API Key</h3>
                    </div>
                </div>
                <div class="p-4">
                    <div class="flex flex-col gap-3">
                        <div class="flex flex-col sm:flex-row gap-2">
                            <input type="text" class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 font-mono text-sm" id="apiKey" value="https://imhotepexchangeratesapi.pythonanywhere.com/latest_rates/{{api_key}}/USD" readonly>
                            <button class="inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700" id="copyBtn" onclick="copyApiKeyWithFeedback()">
                                <i class="fas fa-copy mr-1"></i> Copy
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="rounded-xl bg-white shadow-sm ring-1 ring-gray-200 mb-4 overflow-hidden">
                <div class="bg-blue-600 text-white px-4 py-3">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-rocket text-xl"></i>
                        <h3 class="m-0 text-base font-semibold">Quick Start Guide</h3>
                    </div>
                </div>
                <div class="p-4">
                    <p class="text-gray-700 mb-4">Get started with the Imhotep Exchange Rate API in just three simple steps:</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-4">
                        <div class="rounded-xl border border-gray-200 bg-gray-50 text-center p-4 shadow-sm">
                            <div class="mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-full bg-blue-700 text-white font-bold">1</div>
                            <h6 class="font-semibold">Copy Your API Key</h6>
                            <p class="text-sm text-gray-600">Use the button above to copy your unique API key</p>
                        </div>
                        <div class="rounded-xl border border-gray-200 bg-gray-50 text-center p-4 shadow-sm">
                            <div class="mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-full bg-blue-700 text-white font-bold">2</div>
                            <h6 class="font-semibold">Make an API Request</h6>
                            <p class="text-sm text-gray-600">Use the endpoint <code class="bg-gray-100 px-1 rounded">/latest_rates/YOUR_API_KEY/USD</code></p>
                        </div>
                        <div class="rounded-xl border border-gray-200 bg-gray-50 text-center p-4 shadow-sm">
                            <div class="mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-full bg-blue-700 text-white font-bold">3</div>
                            <h6 class="font-semibold">Process JSON Response</h6>
                            <p class="text-sm text-gray-600">Get real-time exchange rates for all currencies</p>
                        </div>
                    </div>
                    <div class="text-center">
                        <button class="inline-flex items-center justify-center rounded-full border border-blue-600 px-4 py-2 text-sm font-medium text-blue-700 hover:bg-blue-50" onclick="switchToTab('#documentation')">
                            <i class="fas fa-file-alt mr-1"></i> View Full Documentation
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Convert Tab -->
        <section id="convert" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 items-start">
                <div class="rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200">
                    <h2 class="m-0 text-lg font-semibold mb-4">Convert Currency</h2>
                    <form id="dash-convert-form" class="space-y-4">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <div>
                                <label class="mb-1 block text-sm font-medium text-gray-700">From (Base)</label>
                                <input id="dash_from_currency" type="text" value="USD" class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none" required>
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-gray-700">To (Target)</label>
                                <input id="dash_to_currency" type="text" value="EUR" class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none" required>
                            </div>
                        </div>
                        <div>
                            <label class="mb-1 block text-sm font-medium text-gray-700">Amount</label>
                            <input id="dash_amount" type="number" value="100" min="0" class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none" required>
                        </div>
                        <button type="submit" class="inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700">
                            <i class="fas fa-exchange-alt mr-2"></i> Convert
                        </button>
                    </form>
                </div>
                <div class="rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="m-0 text-sm font-semibold">API Response</h3>
                        <button id="dash-copy-convert-response" class="inline-flex items-center rounded-md border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-50"><i class="fas fa-copy mr-1"></i> Copy</button>
                    </div>
<pre class="m-0 bg-gray-900 text-gray-100 p-3 rounded" id="dash-convert-response"><code>{
  "result": null,
  "status": "waiting for input"
}</code></pre>
                </div>
            </div>
        </section>
        
        <!-- API Keys Tab -->
        <section id="api-keys" class="hidden">
            <div class="rounded-xl bg-white shadow-sm ring-1 ring-gray-200 mb-4 overflow-hidden">
                <div class="bg-blue-700 text-white px-4 py-3">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-key text-xl"></i>
                        <h3 class="m-0 text-base font-semibold">API Key Management</h3>
                    </div>
                </div>
                <div class="p-4">
                    <div class="mb-4">
                        <label class="mb-1 block text-sm font-semibold text-gray-700"><i class="fas fa-tag mr-2"></i>Current API Key:</label>
                        <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                            <input type="text" class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 font-mono text-sm" value="{{api_key}}" readonly>
                            <button class="inline-flex items-center justify-center rounded-md border border-blue-600 px-3 py-2 text-sm font-medium text-blue-700 hover:bg-blue-50" type="button" onclick="copyCustomTextWithFeedback('{{api_key}}', 'key-only-btn')">
                                <i class="fas fa-copy mr-1" id="key-only-btn"></i> Copy Key
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="mb-1 block text-sm font-semibold text-gray-700"><i class="fas fa-link mr-2"></i>Full API URL:</label>
                        <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                            <input type="text" class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 font-mono text-sm" value="https://imhotepexchangeratesapi.pythonanywhere.com/latest_rates/{{api_key}}/USD" readonly>
                            <button class="inline-flex items-center justify-center rounded-md border border-blue-600 px-3 py-2 text-sm font-medium text-blue-700 hover:bg-blue-50" type="button" onclick="copyCustomTextWithFeedback('https://imhotepexchangeratesapi.pythonanywhere.com/latest_rates/{{api_key}}/USD', 'url-btn')">
                                <i class="fas fa-copy mr-1" id="url-btn"></i> Copy URL
                            </button>
                        </div>
                        <div class="mt-2 text-sm text-gray-600"><i class="fas fa-info-circle mr-1 text-blue-600"></i> Use this URL to access the API with USD as the base currency.</div>
                    </div>
                    
                    <div class="rounded-md border border-blue-200 bg-blue-50 p-3 text-blue-800">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 text-xl"></i>
                            <div>
                                <h6 class="font-semibold">API Access Information</h6>
                                <p class="m-0 text-sm">Your API key provides access to all supported currency rates and endpoints. Keep this key confidential.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="rounded-xl bg-white shadow-sm ring-1 ring-gray-200 mb-4 overflow-hidden">
                <div class="bg-indigo-700 text-white px-4 py-3">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-shield-alt text-xl"></i>
                        <h3 class="m-0 text-base font-semibold">Security Recommendations</h3>
                    </div>
                </div>
                <div class="p-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <div class="rounded-xl border border-gray-200 bg-white text-center p-4 shadow-sm">
                            <div class="mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-blue-600 text-white text-xl">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <h6 class="font-semibold">Keep API Key Secret</h6>
                            <p class="text-sm text-gray-600">Never share your API key publicly or commit it to source control</p>
                        </div>
                        <div class="rounded-xl border border-gray-200 bg-white text-center p-4 shadow-sm">
                            <div class="mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-green-600 text-white text-xl">
                                <i class="fas fa-server"></i>
                            </div>
                            <h6 class="font-semibold">Server-Side Requests</h6>
                            <p class="text-sm text-gray-600">Make API requests from your backend, not client-side JavaScript</p>
                        </div>
                        <div class="rounded-xl border border-gray-200 bg-white text-center p-4 shadow-sm">
                            <div class="mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-yellow-500 text-white text-xl">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <h6 class="font-semibold">Rate Limiting</h6>
                            <p class="text-sm text-gray-600">Implement proper rate limiting in your application</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Documentation Tab -->
        <section id="documentation" class="hidden">
            <div class="rounded-xl bg-white shadow-sm ring-1 ring-gray-200 mb-4 overflow-hidden">
                <div class="bg-blue-600 text-white px-4 py-3">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-book text-xl"></i>
                        <h3 class="m-0 text-base font-semibold">API Documentation</h3>
                    </div>
                </div>
                <div class="p-4">
                    <!-- Endpoints -->
                    <div class="mb-5">
                        <h4 class="mb-3 border-b pb-2 flex items-center gap-2 text-lg font-semibold">
                            <i class="fas fa-sitemap text-blue-600"></i> Available Endpoints
                        </h4>
                        <div class="rounded-xl border border-gray-200 bg-white shadow-sm mb-3 overflow-hidden">
                            <div class="bg-gray-50 px-4 py-3">
                                <div class="flex items-center gap-2">
                                    <span class="inline-flex items-center rounded bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800">GET</span>
                                    <h5 class="m-0 font-mono text-sm">/latest_rates/{api_key}/{base_currency}</h5>
                                </div>
                            </div>
                            <div class="p-4">
                                <p class="text-gray-700">Returns the latest exchange rates for all currencies relative to the specified base currency.</p>
                                
                                <div class="rounded-lg border border-gray-200 bg-gray-50 mb-3 overflow-hidden">
                                    <div class="px-4 py-2">
                                        <h6 class="m-0 font-semibold"><i class="fas fa-list-ul mr-2"></i> Parameters</h6>
                                    </div>
                                    <div class="p-0">
                                        <div class="overflow-x-auto">
                                            <table class="w-full text-left text-sm">
                                                <thead class="bg-white">
                                                    <tr class="border-b">
                                                        <th class="px-4 py-2">Name</th>
                                                        <th class="px-4 py-2">Type</th>
                                                        <th class="px-4 py-2">Required</th>
                                                        <th class="px-4 py-2">Description</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="border-b hover:bg-gray-50">
                                                        <td class="px-4 py-2"><code class="bg-gray-100 px-1 rounded">api_key</code></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">string</span></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">Yes</span></td>
                                                        <td class="px-4 py-2">Your unique API key</td>
                                                    </tr>
                                                    <tr class="border-b hover:bg-gray-50">
                                                        <td class="px-4 py-2"><code class="bg-gray-100 px-1 rounded">base_currency</code></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">string</span></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">Yes</span></td>
                                                        <td class="px-4 py-2">Currency code (USD, EUR, GBP, etc.)</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="rounded-lg border border-gray-200 bg-gray-50 overflow-hidden">
                                    <div class="px-4 py-2 flex items-center justify-between">
                                        <h6 class="m-0 font-semibold"><i class="fas fa-reply mr-2"></i> Response Format</h6>
                                        <button class="inline-flex items-center justify-center rounded-md border border-blue-600 px-2 py-1 text-xs font-medium text-blue-700 hover:bg-blue-50" onclick="copyCustomTextWithFeedback(document.getElementById('response-example').textContent, 'response-btn')">
                                            <i class="fas fa-copy mr-1" id="response-btn"></i> Copy Example
                                        </button>
                                    </div>
                                    <div class="p-0">
<pre class="m-0 bg-gray-900 text-gray-100 p-3" id="response-example"><code>{
    "meta": {
        "base_currency": "USD",
        "last_updated_at": "2024-10-24T18:00:00Z"
    },
    "data": {
        "EUR": 0.85,
        "GBP": 0.74,
        "JPY": 110.25,
        ...
    }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Convert Amount Endpoint -->
                        <div class="rounded-xl border border-gray-200 bg-white shadow-sm mb-3 overflow-hidden">
                            <div class="bg-gray-50 px-4 py-3">
                                <div class="flex items-center gap-2">
                                    <span class="inline-flex items-center rounded bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800">GET</span>
                                    <h5 class="m-0 font-mono text-sm">/convert/latest_rates/{api_key}/{base_currency}/{target_currency}/{amount}</h5>
                                </div>
                            </div>
                            <div class="p-4">
                                <p class="text-gray-700">Converts an <span class="font-mono">amount</span> from the <span class="font-mono">base_currency</span> to the <span class="font-mono">target_currency</span> using the latest rates.</p>

                                <div class="rounded-lg border border-gray-200 bg-gray-50 mb-3 overflow-hidden">
                                    <div class="px-4 py-2">
                                        <h6 class="m-0 font-semibold"><i class="fas fa-list-ul mr-2"></i> Parameters</h6>
                                    </div>
                                    <div class="p-0">
                                        <div class="overflow-x-auto">
                                            <table class="w-full text-left text-sm">
                                                <thead class="bg-white">
                                                    <tr class="border-b">
                                                        <th class="px-4 py-2">Name</th>
                                                        <th class="px-4 py-2">Type</th>
                                                        <th class="px-4 py-2">Required</th>
                                                        <th class="px-4 py-2">Description</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="border-b hover:bg-gray-50">
                                                        <td class="px-4 py-2"><code class="bg-gray-100 px-1 rounded">api_key</code></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">string</span></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">Yes</span></td>
                                                        <td class="px-4 py-2">Your unique API key</td>
                                                    </tr>
                                                    <tr class="border-b hover:bg-gray-50">
                                                        <td class="px-4 py-2"><code class="bg-gray-100 px-1 rounded">base_currency</code></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">string</span></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">Yes</span></td>
                                                        <td class="px-4 py-2">Currency code to convert from (e.g., USD)</td>
                                                    </tr>
                                                    <tr class="border-b hover:bg-gray-50">
                                                        <td class="px-4 py-2"><code class="bg-gray-100 px-1 rounded">target_currency</code></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">string</span></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">Yes</span></td>
                                                        <td class="px-4 py-2">Currency code to convert to (e.g., EUR)</td>
                                                    </tr>
                                                    <tr class="border-b hover:bg-gray-50">
                                                        <td class="px-4 py-2"><code class="bg-gray-100 px-1 rounded">amount</code></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">number</span></td>
                                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">Yes</span></td>
                                                        <td class="px-4 py-2">Amount to convert</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <div class="rounded-lg border border-gray-200 bg-gray-50 overflow-hidden">
                                    <div class="px-4 py-2 flex items-center justify-between">
                                        <h6 class="m-0 font-semibold"><i class="fas fa-reply mr-2"></i> Response Example</h6>
                                        <button class="inline-flex items-center justify-center rounded-md border border-blue-600 px-2 py-1 text-xs font-medium text-blue-700 hover:bg-blue-50" onclick="copyCustomTextWithFeedback(document.getElementById('convert-response-doc').textContent, 'convert-response-doc-btn')">
                                            <i class="fas fa-copy mr-1" id="convert-response-doc-btn"></i> Copy Example
                                        </button>
                                    </div>
                                    <div class="p-0">
<pre class="m-0 bg-gray-900 text-gray-100 p-3" id="convert-response-doc"><code>{
  "meta": {
    "base_currency": "USD",
    "target_currency": "EUR",
    "amount": 100,
    "last_updated_at": "2024-10-24T18:00:00Z"
  },
  "data": {
    "rate": 0.85,
    "converted_amount": 85.0
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Error Responses -->
                    <div class="mb-5">
                        <h4 class="mb-3 border-b pb-2 flex items-center gap-2 text-lg font-semibold">
                            <i class="fas fa-exclamation-triangle text-yellow-500"></i> Error Responses
                        </h4>
                        
                        <p class="text-gray-700 mb-3">The API returns detailed error responses to help with debugging. All error responses follow this format:</p>
                        
                        <div class="rounded-lg border border-gray-200 bg-gray-50 mb-4 overflow-hidden">
                            <div class="px-4 py-2 flex items-center justify-between">
                                <h6 class="m-0 font-semibold"><i class="fas fa-exclamation-circle text-red-600 mr-2"></i> Error Response Format</h6>
                                <button class="inline-flex items-center justify-center rounded-md border border-blue-600 px-2 py-1 text-xs font-medium text-blue-700 hover:bg-blue-50" onclick="copyCustomTextWithFeedback(document.getElementById('error-example').textContent, 'error-btn')">
                                    <i class="fas fa-copy mr-1" id="error-btn"></i> Copy Example
                                </button>
                            </div>
                            <div class="p-0">
<pre class="m-0 bg-gray-900 text-gray-100 p-3" id="error-example"><code>{
    "error": {
        "code": 401,
        "message": "Invalid API key"
    }
}</code></pre>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-white">
                                    <tr class="border-b">
                                        <th class="px-4 py-2">Status Code</th>
                                        <th class="px-4 py-2">Error Type</th>
                                        <th class="px-4 py-2">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-yellow-100 px-2 py-0.5 text-xs font-medium text-yellow-800">400</span></td>
                                        <td class="px-4 py-2">Bad Request</td>
                                        <td class="px-4 py-2">The request was malformed or contains invalid parameters</td>
                                    </tr>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">401</span></td>
                                        <td class="px-4 py-2">Unauthorized</td>
                                        <td class="px-4 py-2">Missing or invalid API key</td>
                                    </tr>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-gray-200 px-2 py-0.5 text-xs font-medium text-gray-800">404</span></td>
                                        <td class="px-4 py-2">Not Found</td>
                                        <td class="px-4 py-2">The requested resource could not be found</td>
                                    </tr>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-yellow-100 px-2 py-0.5 text-xs font-medium text-yellow-800">429</span></td>
                                        <td class="px-4 py-2">Too Many Requests</td>
                                        <td class="px-4 py-2">Rate limit exceeded (30 requests per minute)</td>
                                    </tr>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">500</span></td>
                                        <td class="px-4 py-2">Server Error</td>
                                        <td class="px-4 py-2">An error occurred while processing your request</td>
                                    </tr>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2"><span class="inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800">503</span></td>
                                        <td class="px-4 py-2">Service Unavailable</td>
                                        <td class="px-4 py-2">External currency API is unavailable and no fallback data exists</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Graceful Fallbacks -->
                    <div class="mb-5">
                        <h4 class="mb-3 border-b pb-2 flex items-center gap-2 text-lg font-semibold">
                            <i class="fas fa-life-ring text-green-600"></i> Graceful Fallbacks
                        </h4>
                        
                        <p class="text-gray-700">If the external currency API is unavailable, the service will automatically return cached data with a warning:</p>
                        
                        <div class="rounded-lg border border-gray-200 bg-gray-50 mb-3 overflow-hidden">
                            <div class="px-4 py-2 flex items-center justify-between">
                                <h6 class="m-0 font-semibold"><i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i> Fallback Response Format</h6>
                                <button class="inline-flex items-center justify-center rounded-md border border-blue-600 px-2 py-1 text-xs font-medium text-blue-700 hover:bg-blue-50" onclick="copyCustomTextWithFeedback(document.getElementById('fallback-example').textContent, 'fallback-btn')">
                                    <i class="fas fa-copy mr-1" id="fallback-btn"></i> Copy Example
                                </button>
                            </div>
                            <div class="p-0">
<pre class="m-0 bg-gray-900 text-gray-100 p-3" id="fallback-example"><code>{
    "meta": {
        "base_currency": "USD",
        "last_updated_at": "2024-10-22T18:00:00Z"
    },
    "warning": {
        "message": "Using stale data as fallback. External API could not be reached.",
        "data_age": "2 days old"
    },
    "data": {
        "EUR": 0.85,
        "GBP": 0.74,
        "JPY": 110.25,
        ...
    }
}</code></pre>
                            </div>
                        </div>
                        
                        <div class="rounded-md border border-yellow-200 bg-yellow-50 p-3 text-yellow-900 shadow-sm">
                            <div class="flex items-start gap-3">
                                <i class="fas fa-lightbulb text-yellow-500 text-xl"></i>
                                <div>
                                    <h5 class="m-0 font-semibold">Note on Fallback Data</h5>
                                    <p class="m-0 text-sm">While using fallback data, the exchange rates may not reflect the current market conditions. The API will include a warning with the response indicating that the data is stale and its age.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Code Examples -->
                    <div class="mb-5">
                        <h4 class="mb-3 border-b pb-2 flex items-center gap-2 text-lg font-semibold">
                            <i class="fas fa-code text-green-600"></i> Code Examples
                        </h4>
                        
                        <!-- Code examples sub-tabs -->
                        <div class="inline-flex items-center gap-2 rounded-lg bg-white p-1 shadow-sm ring-1 ring-gray-200 mb-3">
                            <button class="subtab-btn px-3 py-1.5 text-xs font-medium rounded-md bg-gray-900 text-white" data-target="#js-code">JavaScript</button>
                            <button class="subtab-btn px-3 py-1.5 text-xs font-medium rounded-md text-gray-700 hover:bg-gray-50" data-target="#python-code">Python</button>
                        </div>
                        
                        <div>
                            <!-- JavaScript Example -->
                            <div id="js-code" class="block">
                                <div class="rounded-xl bg-gray-900 text-gray-100 shadow-sm mb-3 overflow-hidden">
                                    <div class="flex items-center justify-between px-4 py-2">
                                        <h6 class="m-0 text-sm">JavaScript Example</h6>
                                        <button class="inline-flex items-center justify-center rounded-md border border-gray-300 px-2 py-1 text-xs font-medium text-gray-100 hover:bg-gray-800" onclick="copyCodeExample('js-example')">
                                            <i class="fas fa-copy mr-1"></i> Copy Code
                                        </button>
                                    </div>
                                    <div class="p-0">
<pre class="m-0 p-3" id="js-example"><code>// Fetch exchange rates
const apiKey = '{{api_key}}';
const baseCurrency = 'USD';
const url = `https://imhotepexchangeratesapi.pythonanywhere.com/latest_rates/${apiKey}/${baseCurrency}`;

fetch(url)
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    console.log('Exchange rates:', data);
    // Process your exchange rates here
    const euroRate = data.data.EUR;
    console.log(`1 ${baseCurrency} = ${euroRate} EUR`);
  })
  .catch(error => {
    console.error('Error fetching exchange rates:', error);
  });</code></pre>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Python Example -->
                            <div id="python-code" class="hidden">
                                <div class="rounded-xl bg-gray-900 text-gray-100 shadow-sm mb-3 overflow-hidden">
                                    <div class="flex items-center justify-between px-4 py-2">
                                        <h6 class="m-0 text-sm">Python Example</h6>
                                        <button class="inline-flex items-center justify-center rounded-md border border-gray-300 px-2 py-1 text-xs font-medium text-gray-100 hover:bg-gray-800" onclick="copyCodeExample('python-example')">
                                            <i class="fas fa-copy mr-1"></i> Copy Code
                                        </button>
                                    </div>
                                    <div class="p-0">
<pre class="m-0 p-3" id="python-example"><code>import requests

api_key = '{{api_key}}'
base_currency = 'USD'
url = f'https://imhotepexchangeratesapi.pythonanywhere.com/latest_rates/{api_key}/{base_currency}'

try:
    response = requests.get(url)
    response.raise_for_status()  # Raise exception for 4XX/5XX responses
    data = response.json()
    
    print(f"Exchange rates (base: {data['meta']['base_currency']})")
    print(f"Last updated: {data['meta']['last_updated_at']}")
    
    # Print rates for some common currencies
    common_currencies = ['EUR', 'GBP', 'JPY', 'CAD', 'AUD']
    for currency in common_currencies:
        if currency in data['data']:
            print(f"1 {base_currency} = {data['data'][currency]} {currency}")
            
except requests.exceptions.RequestException as e:
    print(f"Error fetching exchange rates: {e}")</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Rate Limits -->
                    <div>
                        <h4 class="mb-3 border-b pb-2 flex items-center gap-2 text-lg font-semibold">
                            <i class="fas fa-tachometer-alt text-red-600"></i> Rate Limits
                        </h4>
                        <div class="rounded-md border border-blue-200 bg-blue-50 p-3 text-blue-900 shadow-sm">
                            <div class="flex items-start gap-3">
                                <i class="fas fa-info-circle text-blue-600 text-xl"></i>
                                <div>
                                    <h5 class="m-0 font-semibold">Current Limits</h5>
                                    <p class="m-0 text-sm">The API enforces a rate limit of <strong>30 requests per minute</strong> per API key. Our free tier offers unlimited daily requests within this rate limit.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<script>
// Tabs switching
(function(){
    function activateTab(targetSelector){
        var sections = document.querySelectorAll('#dashboardTabContent > section');
        sections.forEach(function(sec){ sec.classList.add('hidden'); sec.classList.remove('block'); });
        var target = document.querySelector(targetSelector);
        if(target){ target.classList.remove('hidden'); target.classList.add('block'); }
        var buttons = document.querySelectorAll('.tab-btn');
        buttons.forEach(function(btn){ btn.classList.remove('bg-blue-600','text-white'); btn.classList.add('text-gray-700'); });
        var activeBtn = Array.from(buttons).find(function(b){ return b.getAttribute('data-target') === targetSelector; });
        if(activeBtn){ activeBtn.classList.add('bg-blue-600','text-white'); activeBtn.classList.remove('text-gray-700'); }
    }
    window.switchToTab = activateTab;
    var tabButtons = document.querySelectorAll('.tab-btn');
    tabButtons.forEach(function(btn){
        btn.addEventListener('click', function(){ activateTab(this.getAttribute('data-target')); });
    });
})();

// Subtabs switching (Documentation code examples)
(function(){
    function activateSubtab(targetSelector){
        var panes = document.querySelectorAll('#documentation > div .hidden, #documentation > div .block');
        // explicitly toggle only our two panes
        ['#js-code','#python-code'].forEach(function(id){
            var el = document.querySelector(id);
            if(el){ el.classList.add('hidden'); el.classList.remove('block'); }
        });
        var target = document.querySelector(targetSelector);
        if(target){ target.classList.remove('hidden'); target.classList.add('block'); }
        var buttons = document.querySelectorAll('.subtab-btn');
        buttons.forEach(function(btn){ btn.classList.remove('bg-gray-900','text-white'); btn.classList.add('text-gray-700'); });
        var activeBtn = Array.from(buttons).find(function(b){ return b.getAttribute('data-target') === targetSelector; });
        if(activeBtn){ activeBtn.classList.add('bg-gray-900','text-white'); activeBtn.classList.remove('text-gray-700'); }
    }
    var subtabButtons = document.querySelectorAll('.subtab-btn');
    subtabButtons.forEach(function(btn){
        btn.addEventListener('click', function(){ activateSubtab(this.getAttribute('data-target')); });
    });
})();

// Copy helpers
function copyApiKeyWithFeedback() {
    var apiKeyElement = document.getElementById('apiKey');
    var copyBtn = document.getElementById('copyBtn');
    var originalBtnText = copyBtn.innerHTML;
    var textToCopy = apiKeyElement.value;
    
    navigator.clipboard.writeText(textToCopy)
        .then(function(){
            copyBtn.innerHTML = '<i class="fas fa-check mr-1"></i> Copied!';
            setTimeout(function(){ copyBtn.innerHTML = originalBtnText; }, 2000);
        })
        .catch(function(){
            copyBtn.innerHTML = '<i class="fas fa-times mr-1"></i> Error!';
            setTimeout(function(){ copyBtn.innerHTML = originalBtnText; }, 2000);
        });
}

function copyCustomTextWithFeedback(text, iconId) {
    var icon = document.getElementById(iconId);
    var originalClass = icon.className;
    navigator.clipboard.writeText(text)
        .then(function(){
            icon.className = 'fas fa-check mr-1';
            setTimeout(function(){ icon.className = originalClass; }, 2000);
        })
        .catch(function(){
            icon.className = 'fas fa-times mr-1';
            setTimeout(function(){ icon.className = originalClass; }, 2000);
        });
}

function copyCodeExample(elementId) {
    var codeElement = document.getElementById(elementId);
    var text = codeElement.textContent;
    navigator.clipboard.writeText(text)
        .then(function(){
            var toast = document.createElement('div');
            toast.style.position = 'fixed';
            toast.style.bottom = '20px';
            toast.style.right = '20px';
            toast.style.backgroundColor = '#16a34a';
            toast.style.color = 'white';
            toast.style.padding = '10px 20px';
            toast.style.borderRadius = '6px';
            toast.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
            toast.style.zIndex = '9999';
            toast.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            toast.style.opacity = '0';
            toast.style.transform = 'translateY(20px)';
            toast.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Code copied to clipboard!';
            document.body.appendChild(toast);
            setTimeout(function(){ toast.style.opacity = '1'; toast.style.transform = 'translateY(0)'; }, 10);
            setTimeout(function(){
                toast.style.opacity = '0'; toast.style.transform = 'translateY(20px)';
                setTimeout(function(){ document.body.removeChild(toast); }, 300);
            }, 2500);
        });
}

// Convert on dashboard
(function(){
    var form = document.getElementById('dash-convert-form');
    var responseEl = document.getElementById('dash-convert-response');
    var copyBtn = document.getElementById('dash-copy-convert-response');
    if(form){
        form.addEventListener('submit', function(e){
            e.preventDefault();
            var apiKey = '{{api_key}}';
            var from = document.getElementById('dash_from_currency').value.trim();
            var to = document.getElementById('dash_to_currency').value.trim();
            var amount = document.getElementById('dash_amount').value.trim();
            if(!apiKey || !from || !to || !amount){ return; }
            var url = '/convert/latest_rates/' + encodeURIComponent(apiKey) + '/' + encodeURIComponent(from) + '/' + encodeURIComponent(to) + '/' + encodeURIComponent(amount);
            fetch(url)
                .then(function(res){ return res.json(); })
                .then(function(data){ responseEl.textContent = JSON.stringify(data, null, 2); })
                .catch(function(err){ responseEl.textContent = JSON.stringify({ error: String(err) }, null, 2); });
        });
    }
    if(copyBtn && responseEl){
        copyBtn.addEventListener('click', function(){ navigator.clipboard.writeText(responseEl.textContent); });
    }
})();
</script>

{% endblock %}
